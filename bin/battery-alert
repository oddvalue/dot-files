#!/bin/bash
pid=$(pgrep -u $(whoami) gnome-session | head -n 1)
dbus=$(grep -z DBUS_SESSION_BUS_ADDRESS /proc/$pid/environ | sed 's/DBUS_SESSION_BUS_ADDRESS=//' )
export DBUS_SESSION_BUS_ADDRESS=$dbus
export DISPLAY=:1
battery_level=$(cat /sys/class/power_supply/BAT0/capacity)
battery_status=$(cat /sys/class/power_supply/BAT0/status)
if [ "$battery_status" = "Charging" ]; then
    if [ "$battery_level" -ge 80 ]; then
        notify-send -u critical "Battery at 80%, time to unplug ðŸ˜Ž" -t 30000
        pacmd play-file /usr/share/sounds/gnome/default/alerts/glass.ogg 1
    fi
fi
